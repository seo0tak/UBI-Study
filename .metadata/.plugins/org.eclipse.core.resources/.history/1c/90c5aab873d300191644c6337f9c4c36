<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board.BoardBean" >

	<select resultType="int" id="GetTotalCount">
		select count(*) from board
		<if test="whatColumn == 'name'">where name like #{keyword} </if>
		<if test="whatColumn == 'title'">where title like #{keyword} </if>
		<if test="whatColumn == 'all'">where title like #{keyword} or name like #{keyword}</if>
	</select>
	
	<select resultType="MyBoard" id="GetDataList" parameterType="hashmap" >
		select num, ref, relevel, readcount, title, name, content 
		from (select rownum as rank, num, ref, relevel, readcount, title, name, content 
		from (select num, ref, relevel, readcount, title, name, content 
		from board 
		order by ref desc, num asc )) 
		<if test="whatColumn == 'name'">where name like #{keyword} </if>
		<if test="whatColumn == 'title'">where title like #{keyword} </if>
		<if test="whatColumn == 'all'">where title like #{keyword} or name like #{keyword} </if>
	</select>

	<select id="GetData" resultType="board.model.BoardBean">
		select * from board
		where num = #{num}
	</select>
	
	<update id="updateReadCount" parameterType="MyBoard">
		update board set readcount=readcount+1 where num=#{num}
	</update>
	
	<insert id="insertRef" parameterType="MyBoard">
		insert into board(num,ref,relevel,readcount,title,name,content) values(board_seq.nextval, #{ref, jdbcType=INTEGER}, #{relevel, jdbcType=INTEGER}, #{readcount, jdbcType=INTEGER}, #{title,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR}, #{content,jdbcType=VARCHAR})
	</insert>
	
	<select id="InsertBoard" resultType="MyBoard">
		insert into board values(board_seq.nextval,board_seq.currval,0,0,#{title},#{name},#{content})
	</select>
	
	<update id="UpdateBoard">
		update board set name=#{name}, title=#{title}, content=#{content} where num=#{num}
	</update>
	
	<delete id="DeleteBoard">	
		delete board where num=#{num}
	</delete>
</mapper>